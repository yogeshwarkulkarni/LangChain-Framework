{"version":3,"file":"google.js","names":["message: AIMessage","contentBlockBase: ContentBlock.Standard","contentBlock: ContentBlock.Standard","reasoning: string","ret: ContentBlock.Standard","ChatGoogleTranslator: StandardContentBlockTranslator"],"sources":["../../../src/messages/block_translators/google.ts"],"sourcesContent":["import { AIMessage } from \"../ai.js\";\nimport { ContentBlock } from \"../content/index.js\";\nimport type { StandardContentBlockTranslator } from \"./index.js\";\nimport { iife, _isContentBlock, _isObject, _isString } from \"./utils.js\";\n\nfunction convertToV1FromChatGoogleMessage(\n  message: AIMessage\n): Array<ContentBlock.Standard> {\n  function* iterateContent(): Iterable<ContentBlock.Standard> {\n    const content = iife(() => {\n      if (typeof message.content === \"string\") {\n        if (message.additional_kwargs.originalTextContentBlock) {\n          return [\n            {\n              ...message.additional_kwargs.originalTextContentBlock,\n              type: \"text\",\n            },\n          ];\n        } else {\n          return [{ type: \"text\", text: message.content }];\n        }\n      } else {\n        return message.content;\n      }\n    });\n    for (const block of content) {\n      const contentBlockBase: ContentBlock.Standard = iife(() => {\n        if (_isContentBlock(block, \"text\") && _isString(block.text)) {\n          return {\n            type: \"text\",\n            text: block.text,\n          };\n        } else if (\n          _isContentBlock(block, \"inlineData\") &&\n          _isObject(block.inlineData) &&\n          _isString(block.inlineData.mimeType) &&\n          _isString(block.inlineData.data)\n        ) {\n          return {\n            type: \"file\",\n            mimeType: block.inlineData.mimeType,\n            data: block.inlineData.data,\n          };\n        } else if (\n          _isContentBlock(block, \"functionCall\") &&\n          _isObject(block.functionCall) &&\n          _isString(block.functionCall.name) &&\n          _isObject(block.functionCall.args)\n        ) {\n          return {\n            type: \"tool_call\",\n            id: message.id,\n            name: block.functionCall.name,\n            args: block.functionCall.args,\n          };\n        } else if (_isContentBlock(block, \"functionResponse\")) {\n          return { type: \"non_standard\", value: block };\n        } else if (\n          _isContentBlock(block, \"fileData\") &&\n          _isObject(block.fileData) &&\n          _isString(block.fileData.mimeType) &&\n          _isString(block.fileData.fileUri)\n        ) {\n          return {\n            type: \"file\",\n            mimeType: block.fileData.mimeType,\n            fileId: block.fileData.fileUri,\n          };\n        } else if (_isContentBlock(block, \"executableCode\")) {\n          return { type: \"non_standard\", value: block };\n        } else if (_isContentBlock(block, \"codeExecutionResult\")) {\n          return { type: \"non_standard\", value: block };\n        }\n        return { type: \"non_standard\", value: block };\n      });\n      const contentBlock: ContentBlock.Standard = iife(() => {\n        if (\"thought\" in block && block.thought) {\n          const reasoning: string =\n            contentBlockBase.type === \"text\" ? contentBlockBase.text : \"\";\n          return {\n            type: \"reasoning\",\n            reasoning,\n            reasoningContentBlock: contentBlockBase,\n          };\n        } else {\n          return contentBlockBase;\n        }\n      });\n\n      const ret: ContentBlock.Standard = {\n        thought: block.thought,\n        thoughtSignature: block.thoughtSignature,\n        partMetadata: block.partMetadata,\n        ...contentBlock,\n      };\n      for (const attribute in ret) {\n        if (ret[attribute] === undefined) {\n          delete ret[attribute];\n        }\n      }\n\n      yield ret;\n      continue;\n    }\n  }\n  return Array.from(iterateContent());\n}\n\nexport const ChatGoogleTranslator: StandardContentBlockTranslator = {\n  translateContent: convertToV1FromChatGoogleMessage,\n  translateContentChunk: convertToV1FromChatGoogleMessage,\n};\n"],"mappings":";;;AAKA,SAAS,iCACPA,SAC8B;CAC9B,UAAU,iBAAkD;EAC1D,MAAM,UAAU,KAAK,MAAM;AACzB,OAAI,OAAO,QAAQ,YAAY,SAC7B,KAAI,QAAQ,kBAAkB,yBAC5B,QAAO,CACL;IACE,GAAG,QAAQ,kBAAkB;IAC7B,MAAM;GACP,CACF;OAED,QAAO,CAAC;IAAE,MAAM;IAAQ,MAAM,QAAQ;GAAS,CAAC;OAGlD,QAAO,QAAQ;EAElB,EAAC;AACF,OAAK,MAAM,SAAS,SAAS;GAC3B,MAAMC,mBAA0C,KAAK,MAAM;AACzD,QAAI,gBAAgB,OAAO,OAAO,IAAI,UAAU,MAAM,KAAK,CACzD,QAAO;KACL,MAAM;KACN,MAAM,MAAM;IACb;aAED,gBAAgB,OAAO,aAAa,IACpC,UAAU,MAAM,WAAW,IAC3B,UAAU,MAAM,WAAW,SAAS,IACpC,UAAU,MAAM,WAAW,KAAK,CAEhC,QAAO;KACL,MAAM;KACN,UAAU,MAAM,WAAW;KAC3B,MAAM,MAAM,WAAW;IACxB;aAED,gBAAgB,OAAO,eAAe,IACtC,UAAU,MAAM,aAAa,IAC7B,UAAU,MAAM,aAAa,KAAK,IAClC,UAAU,MAAM,aAAa,KAAK,CAElC,QAAO;KACL,MAAM;KACN,IAAI,QAAQ;KACZ,MAAM,MAAM,aAAa;KACzB,MAAM,MAAM,aAAa;IAC1B;aACQ,gBAAgB,OAAO,mBAAmB,CACnD,QAAO;KAAE,MAAM;KAAgB,OAAO;IAAO;aAE7C,gBAAgB,OAAO,WAAW,IAClC,UAAU,MAAM,SAAS,IACzB,UAAU,MAAM,SAAS,SAAS,IAClC,UAAU,MAAM,SAAS,QAAQ,CAEjC,QAAO;KACL,MAAM;KACN,UAAU,MAAM,SAAS;KACzB,QAAQ,MAAM,SAAS;IACxB;aACQ,gBAAgB,OAAO,iBAAiB,CACjD,QAAO;KAAE,MAAM;KAAgB,OAAO;IAAO;aACpC,gBAAgB,OAAO,sBAAsB,CACtD,QAAO;KAAE,MAAM;KAAgB,OAAO;IAAO;AAE/C,WAAO;KAAE,MAAM;KAAgB,OAAO;IAAO;GAC9C,EAAC;GACF,MAAMC,eAAsC,KAAK,MAAM;AACrD,QAAI,aAAa,SAAS,MAAM,SAAS;KACvC,MAAMC,YACJ,iBAAiB,SAAS,SAAS,iBAAiB,OAAO;AAC7D,YAAO;MACL,MAAM;MACN;MACA,uBAAuB;KACxB;IACF,MACC,QAAO;GAEV,EAAC;GAEF,MAAMC,MAA6B;IACjC,SAAS,MAAM;IACf,kBAAkB,MAAM;IACxB,cAAc,MAAM;IACpB,GAAG;GACJ;AACD,QAAK,MAAM,aAAa,IACtB,KAAI,IAAI,eAAe,QACrB,OAAO,IAAI;GAIf,MAAM;AACN;EACD;CACF;AACD,QAAO,MAAM,KAAK,gBAAgB,CAAC;AACpC;AAED,MAAaC,uBAAuD;CAClE,kBAAkB;CAClB,uBAAuB;AACxB"}